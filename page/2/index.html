<!DOCTYPE html>
<html lang="zh-Hans">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="戛戛Happy" />


    
     
        <meta name="google-site-verification" content="mRjQM6azHRnllmCObIorLO1p8dqt92U33mbEzoA2HnU" />
    


<meta property="og:type" content="website">
<meta property="og:title" content="漂自己的移，让别人都撞墙去吧">
<meta property="og:url" content="http://www.gagahappy.com/page/2/index.html">
<meta property="og:site_name" content="漂自己的移，让别人都撞墙去吧">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="漂自己的移，让别人都撞墙去吧">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="漂自己的移，让别人都撞墙去吧" type="application/atom+xml">





    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">


<link rel="stylesheet" href="/css/style.css">


    <style> .article { opacity: 0;} </style>


<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>漂自己的移，让别人都撞墙去吧</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: true,
        isPost: false,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: undefined
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/huitailang.jpg" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">戛戛Happy</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">主页</a></li>
                        
                            <li><a href="/archives/">所有文章</a></li>
                        
                            <li><a href="/tag/">标签云</a></li>
                        
                            <li><a href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa RSS" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Facebook" href="#" title="Facebook"></a>
                            
                                <a class="fa Twitter" href="#" title="Twitter"></a>
                            
                                <a class="fa Instagram" href="#" title="Instagram"></a>
                            
                                <a class="fa _500px" href="#" title="_500px"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tag/avril/">Avril</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/bdd/">BDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/hotspot-shield/">Hotspot Shield</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/rails/">Rails</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/ruby/">Ruby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/subversion/">Subversion</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/tdd/">TDD</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/taandme/">Ta们的我</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/vmware/">VMware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/adwords/">adwords</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/ajax/">ajax</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/apache/">apache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/apple/">apple</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/bootstrap/">bootstrap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/c-lang/">c-lang</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/chrome/">chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/docker/">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/dropbox/">dropbox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/facebook/">facebook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/fcitx/">fcitx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/fedora/">fedora</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/firefox/">firefox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/flash/">flash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/git/">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/google/">google</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/innodb/">innodb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/iphone/">iphone</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/jquery/">jquery</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/mac/">mac</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/memcached/">memcached</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/netbeans/">netbeans</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/opera/">opera</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/photograph/">photograph</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/postgresql/">postgresql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/pry/">pry</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/rack/">rack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/resque/">resque</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/rspec/">rspec</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/rubymine/">rubymine</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/rvm/">rvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/s3/">s3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/scrum/">scrum</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/starbucks/">starbucks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/sublime/">sublime</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/svn/">svn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/textmate/">textmate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/thin/">thin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/twitter/">twitter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/vim/">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/virtualbox/">virtualbox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/win7/">win7</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/wordpress/">wordpress</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/people/">人物</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/frontend/">前端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/entertainment/">娱乐</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/wedding/">婚礼</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/youknow/">小知识</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/caipiao/">彩票</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/weibo/">微博</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/photographer/">摄影</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/os/">操作系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/agile/">敏捷</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/news/">新闻</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/funny/">有趣</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/browser/">浏览器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/life/">生活</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/movie/">电影</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/tv/">电视剧</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/cate/">美食</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/zhuangxiu/">装修</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/finance/">财经</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/shopping/">购物</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tag/rubik/">魔方</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/">GitHub</a>
                    
                    </div>
                </section>
                

                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">戛戛Happy</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/huitailang.jpg" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">戛戛Happy</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">主页</a></li>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/tag/">标签云</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa RSS" target="_blank" href="/atom.xml" title="RSS"></a>
                            
                                <a class="fa Facebook" target="_blank" href="#" title="Facebook"></a>
                            
                                <a class="fa Twitter" target="_blank" href="#" title="Twitter"></a>
                            
                                <a class="fa Instagram" target="_blank" href="#" title="Instagram"></a>
                            
                                <a class="fa _500px" target="_blank" href="#" title="_500px"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="标签" friends="友情链接" about="关于我"/>
</nav>
      <div class="body-wrap">
  
    <article id="post-scope-of-instance-variable-in-rake-block" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/scope-of-instance-variable-in-rake-block/" class="article-date">
      <time datetime="2015-04-30T05:20:05.000Z" itemprop="datePublished">2015-04-30</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/scope-of-instance-variable-in-rake-block/">rake 实例变量作用范围</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>rake 实例变量作用范围,可以看到在task的block中，当前self为main，所以@people可以在say方法中访问。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">desc <span class="string">"test instance variable"</span></div><div class="line">task <span class="symbol">:hello_world</span> =&gt; <span class="symbol">:environment</span> <span class="keyword">do</span></div><div class="line">  @people = <span class="string">"Jone"</span></div><div class="line">  puts <span class="keyword">self</span> <span class="comment">#=&gt;main</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">say</span></span></div><div class="line">    puts <span class="keyword">self</span> <span class="comment">#=&gt;main</span></div><div class="line">    puts @people</div><div class="line">  <span class="keyword">end</span></div><div class="line">  say</div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="comment">#=&gt;main</span></div><div class="line"><span class="comment">#=&gt;main</span></div><div class="line"><span class="comment">#=&gt;Jone</span></div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-issues-of-install-memcached-reds-postgresql" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/issues-of-install-memcached-reds-postgresql/" class="article-date">
      <time datetime="2015-04-29T15:53:38.000Z" itemprop="datePublished">2015-04-29</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/issues-of-install-memcached-reds-postgresql/">安装memcached、redis、postgresql问题总结</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>编译 <code>./configure --prefix=/srv/memcached/memcached145 --with-libevent=/usr/</code><br>需要安装 libevent ，安装时要确保知道安装路径</p>
<p>启动memcached<br><code>memcached -d -u root -m 200 -P /tmp/memcached.pid</code></p>
<p>安装redis<br><code>make PREFIX=/srv/redis/redis2815 install</code></p>
<p>启动:daemonize yes: Make redis run as a daemon<br><code>redis-server /usr/etc/redis.conf</code></p>
<p>安装postgresql，遇到问题:Can’t find the ‘libpq-fe.h header<br>解决方法:</p>
<ol>
<li><code>gem install pg -v &#39;0.18.1&#39; -- --with-pg-config=/path/config
--with-pg=/path/pg --with-pg-lib=/path/</code></li>
<li><code>yum install postgresql-devel</code><br>最终用方法2解决<br><code>yum list installed | grep postgres</code></li>
</ol>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/postgresql/">postgresql</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/redis/">redis</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-deploy-nginx-thin" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/deploy-nginx-thin/" class="article-date">
      <time datetime="2015-04-28T05:46:16.000Z" itemprop="datePublished">2015-04-28</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/deploy-nginx-thin/">部署thin + nginx</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>部署thin + nginx<br>生成配置文件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">thin config -C /etc/thin/&lt;config-name&gt;.yml -c &lt;rails-app-root-path&gt; --servers &lt;number-of-threads&gt; <span class="_">-e</span> &lt;environment&gt;</div><div class="line"></div><div class="line">thin config -C /etc/thin/myapp.yml -c /var/rails/myapp --servers 5 --socket /tmp/thin.myapp.sock <span class="_">-e</span> development</div><div class="line"></div><div class="line">替换&lt;config-name&gt;为自己的应用名称，替换&lt;rails-app-root-path&gt;为应用的根目录，替换&lt;number-of-threads&gt;为启动的线程数，也就是启动多少个Thin服务，替换&lt;environment&gt;为运行环境。</div></pre></td></tr></table></figure></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="symbol">thin:</span></div><div class="line"><span class="symbol">environment:</span> development</div><div class="line"><span class="symbol">address:</span> <span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span>.<span class="number">0</span></div><div class="line"><span class="symbol">port:</span> <span class="number">3001</span></div><div class="line"><span class="symbol">timeout:</span> <span class="number">30</span></div><div class="line"><span class="symbol">log:</span> log/thin.log</div><div class="line"><span class="symbol">pid:</span> tmp/pids/thin.pid</div><div class="line"><span class="symbol">max_conns:</span> <span class="number">1024</span></div><div class="line"><span class="symbol">max_persistent_conns:</span> <span class="number">512</span></div><div class="line"><span class="symbol">wait:</span> <span class="number">30</span></div><div class="line"><span class="symbol">servers:</span> <span class="number">2</span></div><div class="line"><span class="symbol">daemonize:</span> <span class="literal">true</span></div><div class="line"><span class="comment"># require: []</span></div></pre></td></tr></table></figure>
<p>启动: <code>thin start -C config/thin.yml</code><br>停止: <code>thin stop -C config/thin.yml</code></p>
<p>nginx:<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">server &#123;</div><div class="line">     listen 3001;</div><div class="line">     charset utf-8;</div><div class="line">     root /var/rails/mysapp/public;</div><div class="line">     access_log logs/access.log;</div><div class="line">     error_log  logs/error.log;</div><div class="line"></div><div class="line">     location / &#123;</div><div class="line">         <span class="comment"># proxy_pass          http://rails_servers;</span></div><div class="line">         <span class="comment"># proxy_redirect      default;</span></div><div class="line">         proxy_redirect      <span class="literal">false</span>;</div><div class="line">         proxy_set_header    X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</div><div class="line">         proxy_set_header    X-Real-IP <span class="variable">$remote_addr</span>;</div><div class="line">         proxy_set_header    Host <span class="variable">$http_host</span>;</div><div class="line">         proxy_next_upstream http_502 http_504 error timeout invalid_header;</div><div class="line">         proxy_pass <span class="literal">false</span>;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> (<span class="_">-f</span> <span class="variable">$request_filename</span>/index.html)</div><div class="line">        &#123;</div><div class="line">          rewrite (.*) <span class="variable">$1</span>/index.html <span class="built_in">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (<span class="_">-f</span> <span class="variable">$request_filename</span>.html) &#123;</div><div class="line">          rewrite (.*) <span class="variable">$1</span>.html <span class="built_in">break</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> (!<span class="_">-f</span> <span class="variable">$request_filename</span>) &#123;</div><div class="line">          proxy_pass http://rails_servers;</div><div class="line">          <span class="built_in">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"> &#125;</div><div class="line"> upstream rails_servers&#123;</div><div class="line">        server 127.0.0.1:3002;</div><div class="line">        server 127.0.0.1:3003;</div><div class="line"> &#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/nginx/">nginx</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/thin/">thin</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-rspec-exception-identity-or-equivalence" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/rspec-exception-identity-or-equivalence/" class="article-date">
      <time datetime="2015-04-25T15:59:48.000Z" itemprop="datePublished">2015-04-25</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/rspec-exception-identity-or-equivalence/">rspec exception identity or equivalence</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><code>expect</code> does not support <code>==</code> matcher.<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">expect(actual).to eql(expected)   <span class="comment"># passes if actual.eql?(expected)</span></div><div class="line">expect(actual).to equal(expected) <span class="comment"># passes if actual.equal?(expected)</span></div><div class="line"></div><div class="line"><span class="comment"># <span class="doctag">NOTE:</span> `expect` does not support `==` matcher.</span></div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/rspec/">rspec</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-delegation-be-enhance-by-active-support-in-module" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/delegation-be-enhance-by-active-support-in-module/" class="article-date">
      <time datetime="2015-04-24T15:54:33.000Z" itemprop="datePublished">2015-04-24</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/delegation-be-enhance-by-active-support-in-module/">Delegation be enhance by active support in module</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>基本思想是:</p>
<blockquote>
<ul>
<li>当访问一个对象的方法时，如果这个方法不存，则转发这个方法给委托的对象</li>
<li>Delegation is particularly useful with Active Record associations:</li>
</ul>
</blockquote>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Greeter</span> &lt; ActiveRecord::Base</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">hello</span></span></div><div class="line">    <span class="string">'hello'</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">goodbye</span></span></div><div class="line">    <span class="string">'goodbye'</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> &lt; ActiveRecord::Base</span></div><div class="line">  belongs_to <span class="symbol">:greeter</span></div><div class="line">  delegate <span class="symbol">:hello</span>, <span class="symbol">to:</span> <span class="symbol">:greeter</span></div><div class="line"><span class="keyword">end</span></div><div class="line"></div><div class="line">Foo.new.hello   <span class="comment"># =&gt; "hello"</span></div><div class="line">Foo.new.goodbye <span class="comment"># =&gt; NoMethodError: undefined method `goodbye' for #&lt;Foo:0x1af30c&gt;</span></div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/gossip/">杂七杂八</a>
    </div>


      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-pg-connection-bad" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/pg-connection-bad/" class="article-date">
      <time datetime="2015-04-23T07:45:18.000Z" itemprop="datePublished">2015-04-23</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/pg-connection-bad/">pg连接错误</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>pg连接错误</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">postgresql_adapter.rb:1216:<span class="keyword">in</span> `initialize<span class="string">': 致命错误:  用户 "pgsql" Ident 认证失败 (PG::ConnectionBad)</span></div></pre></td></tr></table></figure>
<blockquote>
<p>问题环境<br>在安装postgresql_server的机器上，部署rails应用，连接时host:127.0.0.1出现以上错误，改为ip地址后，正常访问</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/database/">数据库</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/postgresql/">postgresql</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-ruby-hash-sort" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/ruby-hash-sort/" class="article-date">
      <time datetime="2015-04-21T16:04:33.000Z" itemprop="datePublished">2015-04-22</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/ruby-hash-sort/">ruby hash 排序</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>ruby hash 排序<br><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">h = &#123;<span class="string">"sa"</span>=&gt;<span class="number">1</span>, <span class="string">"ab"</span>=&gt;<span class="number">2</span>, <span class="string">"x3"</span>=&gt;<span class="number">3</span>, <span class="string">"de"</span>=&gt;, <span class="symbol">:de=&gt;</span><span class="number">5</span>&#125;</div><div class="line">h.sort_by&#123;<span class="params">|k,v|</span>k.to_s&#125;</div><div class="line"><span class="comment">#=&gt; [["ab", 2], [:de, 5], ["de", 6], ["sa", 1], ["x3", 3]]</span></div><div class="line"></div><div class="line">h.sort_by&#123;<span class="params">|k,v|</span>v.to_s&#125;</div><div class="line"><span class="comment">#=&gt;[["sa", 1], ["ab", 2], ["x3", 3], [:de, 5], ["de", 6]]</span></div><div class="line"></div><div class="line">h.sort_by&#123;<span class="params">|k|</span>k[<span class="number">0</span>].to_s&#125;</div><div class="line"><span class="comment">#=&gt;[["ab", 2], [:de, 5], ["de", 6], ["sa", 1], ["x3", 3]]</span></div><div class="line"></div><div class="line">h.sort_by&#123;<span class="params">|k|</span>k[<span class="number">1</span>].to_s&#125;</div><div class="line"><span class="comment">#=&gt;[["sa", 1], ["ab", 2], ["x3", 3], [:de, 5], ["de", 6]]</span></div><div class="line"></div><div class="line">h = &#123;<span class="string">"sa"</span>=&gt;<span class="number">1</span>, <span class="string">"ab"</span>=&gt;<span class="number">2</span>, <span class="string">"x3"</span>=&gt;<span class="number">3</span>, <span class="string">"de"</span>=&gt;<span class="number">6</span>, <span class="symbol">:de=&gt;</span><span class="number">5</span>&#125;</div><div class="line">h.sort</div><div class="line"><span class="comment">#=&gt;argumentError: comparison of Array with Array failed,因为:de=&gt;5与"de"＝&gt;6 Key类型不一样,键类型一样，才可以直接用sort,按键排序，否则要把键处理为一致的数据(可以比较的数据类型)</span></div></pre></td></tr></table></figure></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-bundler-specify-gem-versions" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/bundler-specify-gem-versions/" class="article-date">
      <time datetime="2015-04-21T07:29:52.000Z" itemprop="datePublished">2015-04-21</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/bundler-specify-gem-versions/">bundler Specify gem versions</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>Most of the version specifiers, like &gt;= 1.0, are self-explanatory. The specifier ~&gt; has a special meaning, best shown by example. ~&gt; 2.0.3 is identical to &gt;= 2.0.3 and &lt; 2.1. ~&gt; 2.1 is identical to &gt;= 2.1 and &lt; 3.0. ~&gt; 2.2.beta will match prerelease versions like 2.2.beta.12.</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-rspec-exception-types-classes-response" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/rspec-exception-types-classes-response/" class="article-date">
      <time datetime="2015-04-19T16:08:16.000Z" itemprop="datePublished">2015-04-20</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/rspec-exception-types-classes-response/">rspec exception types classes response</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Types/classes/response</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">expect(actual).to be_instance_of(expected)</div><div class="line">expect(actual).to be_kind_of(expected)</div><div class="line">expect(actual).to respond_to(expected)</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/rspec/">rspec</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-native-extension-to-perform-the-binary-search-within-the-hashring" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/native-extension-to-perform-the-binary-search-within-the-hashring/" class="article-date">
      <time datetime="2015-04-19T07:59:39.000Z" itemprop="datePublished">2015-04-19</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/native-extension-to-perform-the-binary-search-within-the-hashring/">Native extension to perform the binary search within the hashring</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ul>
<li>可以看到为了提高查询性能，采用C去实现，如果安装了RubyInline,会启动C扩展实现的同名方法，加速binary_search查询性能</li>
<li>也可以发现，从客户端分配键到哪个redis节点是通过比较节点的crc32与key的crc32的大小的方式，进行分配的<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> &lt;&lt; self</span></div><div class="line">  <span class="comment"># gem install RubyInline to use this code</span></div><div class="line">  <span class="comment"># Native extension to perform the binary search within the hashring.</span></div><div class="line">  <span class="comment"># There's a pure ruby version below so this is purely optional</span></div><div class="line">  <span class="comment"># for performance.  In testing 20k gets and sets, the native</span></div><div class="line">  <span class="comment"># binary search shaved about 12% off the runtime (9sec -&gt; 8sec).</span></div><div class="line">  <span class="keyword">begin</span></div><div class="line">    <span class="keyword">require</span> <span class="string">'inline'</span></div><div class="line">    inline <span class="keyword">do</span> <span class="params">|builder|</span></div><div class="line">      builder.c &lt;&lt;-EOM</div><div class="line">      int binary_search(VALUE ary, unsigned int r) &#123;</div><div class="line">          int upper = RARRAY_LEN(ary) - <span class="number">1</span>;</div><div class="line">          int lower = <span class="number">0</span>;</div><div class="line">          int idx = <span class="number">0</span>;</div><div class="line"></div><div class="line">          <span class="keyword">while</span> (lower &lt;= upper) &#123;</div><div class="line">              idx = (lower + upper) / <span class="number">2</span>;</div><div class="line"></div><div class="line">              VALUE continuumValue = RARRAY_PTR(ary)[idx];</div><div class="line">              unsigned int l = NUM2UINT(continuumValue);</div><div class="line">              <span class="keyword">if</span> (l == r) &#123;</div><div class="line">                  <span class="keyword">return</span> idx;</div><div class="line">              &#125;</div><div class="line">              <span class="keyword">else</span> <span class="keyword">if</span> (l &gt; r) &#123;</div><div class="line">                  upper = idx - <span class="number">1</span>;</div><div class="line">              &#125;</div><div class="line">              <span class="keyword">else</span> &#123;</div><div class="line">                  lower = idx + <span class="number">1</span>;</div><div class="line">              &#125;</div><div class="line">          &#125;</div><div class="line">          <span class="keyword">if</span> (upper &lt; <span class="number">0</span>) &#123;</div><div class="line">            upper = RARRAY_LEN(ary) - <span class="number">1</span>;</div><div class="line">          &#125;</div><div class="line">          <span class="keyword">return</span> upper;</div><div class="line">      &#125;</div><div class="line">      EOM</div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">rescue</span> Exception</div><div class="line">    <span class="comment"># Find the closest index in HashRing with value &lt;= the given value</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">binary_search</span><span class="params">(ary, value, &amp;block)</span></span></div><div class="line">      .....</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/redis/">redis</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-rspec-exception-comparisons" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/rspec-exception-comparisons/" class="article-date">
      <time datetime="2015-04-17T16:05:24.000Z" itemprop="datePublished">2015-04-18</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/rspec-exception-comparisons/">rspec exception comparisons</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>rspec exception comparisons</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">expect(actual).to be &gt;  expected</div><div class="line">expect(actual).to be &gt;= expected</div><div class="line">expect(actual).to be &lt;= expected</div><div class="line">expect(actual).to be &lt;  expected</div><div class="line">expect(actual).to be_between(minimum, maximum).inclusive</div><div class="line">expect(actual).to be_between(minimum, maximum).exclusive</div><div class="line">expect(actual).to match(<span class="regexp">/expression/</span>)</div><div class="line">expect(actual).to be_within(delta).of(expected)</div><div class="line">expect(actual).to start_with expected</div><div class="line">expect(actual).to end_with expected</div></pre></td></tr></table></figure>
      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/rspec/">rspec</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-secret-token-issues" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/secret-token-issues/" class="article-date">
      <time datetime="2015-04-16T05:31:28.000Z" itemprop="datePublished">2015-04-16</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/secret-token-issues/">secret_token:问题</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>secret_token:问题</p>
<blockquote>
<p>A secret is required to generate an integrity hash for cookie session data. Use config.secret_token = “some secret phrase of at least 30 characters”in config/initializers/secret_token.rb</p>
</blockquote>
<p>解决方法:</p>
<blockquote>
<p>运行 rake secret 生成secret_token，创建config/initializers/secret_token.rb，添加代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">YouApp::Application.config.secret_token = &apos;用 rake secret 生成的token&apos;</div></pre></td></tr></table></figure></p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-redis-hyperloglog-command" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/redis-hyperloglog-command/" class="article-date">
      <time datetime="2015-04-15T15:42:45.000Z" itemprop="datePublished">2015-04-15</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/redis-hyperloglog-command/">redis HyperLogLog 命令</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <ol>
<li>返回储存在给定键的 HyperLogLog 的近似基数</li>
<li>通过 HyperLogLog 数据结构， 用户可以使用少量固定大小的内存， 来储存集合中的唯一元素 （每个 HyperLogLog 只需使用 12k 字节内存，以及几个字节的内存来储存键本身）。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">redis&gt; PFADD  databases  &quot;Redis&quot;  &quot;MongoDB&quot;  &quot;MySQL&quot;</div><div class="line">(integer) 1</div><div class="line"></div><div class="line">redis&gt; PFCOUNT  databases</div><div class="line">(integer) 3</div><div class="line"></div><div class="line">redis&gt; PFADD  databases  &quot;Redis&quot;    # Redis 已经存在，不必对估计数量进行更新</div><div class="line">(integer) 0</div><div class="line"></div><div class="line">redis&gt; PFCOUNT  databases    # 元素估计数量没有变化</div><div class="line">(integer) 3</div><div class="line"></div><div class="line">redis&gt; PFADD  databases  &quot;PostgreSQL&quot;    # 添加一个不存在的元素</div><div class="line">(integer) 1</div><div class="line"></div><div class="line">redis&gt; PFCOUNT  databases    # 估计数量增一</div><div class="line">4</div></pre></td></tr></table></figure>
</li>
</ol>
<blockquote>
<p>问题思考：<br>这个是如何实现的，不存储元素的话，如何知道这个元素已经存在了。</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/redis/">redis</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-rails4-server-up-with-rack" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/rails4-server-up-with-rack/" class="article-date">
      <time datetime="2015-04-14T13:59:42.000Z" itemprop="datePublished">2015-04-14</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/rails4-server-up-with-rack/">rails4  rack调用</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">module</span> <span class="title">Rails</span></span></div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Server</span> &lt; ::<span class="title">Rack::Server</span></span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">default_options</span></span></div><div class="line">      <span class="keyword">super</span>.merge(&#123;</div><div class="line">        <span class="symbol">Port:</span>               <span class="number">3000</span>,</div><div class="line">        <span class="symbol">DoNotReverseLookup:</span> <span class="literal">true</span>,</div><div class="line">        <span class="symbol">environment:</span>        (ENV[<span class="string">'RAILS_ENV'</span>] <span class="params">||</span> ENV[<span class="string">'RACK_ENV'</span>] <span class="params">||</span> <span class="string">"development"</span>).dup,</div><div class="line">        <span class="symbol">daemonize:</span>          <span class="literal">false</span>,</div><div class="line">        <span class="symbol">debugger:</span>           <span class="literal">false</span>,</div><div class="line">        <span class="symbol">pid:</span>                File.expand_path(<span class="string">"tmp/pids/server.pid"</span>),</div><div class="line">        <span class="symbol">config:</span>             File.expand_path(<span class="string">"config.ru"</span>)</div><div class="line">      &#125;)</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">start</span></span></div><div class="line">      print_boot_information</div><div class="line">      trap(<span class="symbol">:INT</span>) &#123; exit &#125;</div><div class="line">      create_tmp_directories</div><div class="line">      log_to_stdout <span class="keyword">if</span> options[<span class="symbol">:log_stdout</span>]</div><div class="line"></div><div class="line">      <span class="keyword">super</span></div><div class="line">    <span class="keyword">ensure</span></div><div class="line">      <span class="comment"># The '-h' option calls exit before <span class="doctag">@options</span> is set.</span></div><div class="line">      <span class="comment"># If we call 'options' with it unset, we get double help banners.</span></div><div class="line">      puts <span class="string">'Exiting'</span> <span class="keyword">unless</span> @options &amp;&amp; options[<span class="symbol">:daemonize</span>]</div><div class="line">    <span class="keyword">end</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>
<p>可以看到和rails2相比，已经大不一样了，代码全部移动到了Rails模块中，结构也更加清晰</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/rails/">Rails</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/ruby/">Ruby</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-segments-for-index-in-innodb" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/segments-for-index-in-innodb/" class="article-date">
      <time datetime="2015-04-12T14:59:54.000Z" itemprop="datePublished">2015-04-12</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/segments-for-index-in-innodb/">segments for index in innodb</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>Two segments are allocated for each index in InnoDB. One is for nonleaf nodes of the B-tree, the other is for the leaf nodes. Keeping the leaf nodes contiguous on disk enables better sequential I/O operations, because these leaf nodes contain the actual table data.</p>
<p>每个索引拥有2个segment，一个用于非叶结点，另一个用于叶子结点</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/database/">数据库</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/innodb/">innodb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/mysql/">mysql</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-innodb-does-not-guarantee-that-it-uses-free-pages-sequentially" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/innodb-does-not-guarantee-that-it-uses-free-pages-sequentially/" class="article-date">
      <time datetime="2015-04-11T15:39:59.000Z" itemprop="datePublished">2015-04-11</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/innodb-does-not-guarantee-that-it-uses-free-pages-sequentially/">Innodb不保证连续的使用空闲空间保存数据</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>InnoDB does not guarantee that it uses free pages sequentially, and many optimizations around bulk data loading will cause pages to be used out of order. (More on page splitting and these optimizations)</p>
<p>1、Innodb不保证连续的使用空闲空间保存数据，这么做的原因有(页的分裂和一些优化)<br>2、在为新数据分配extent时，可以看到有种情况发生：一个index后面是多个free page(63个),然后再是一个index.</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/database/">数据库</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/innodb/">innodb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/mysql/">mysql</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-btree-not-actually-find-a-record" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/btree-not-actually-find-a-record/" class="article-date">
      <time datetime="2015-04-10T12:32:36.000Z" itemprop="datePublished">2015-04-10</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/btree-not-actually-find-a-record/">B+树索引本身并不能找到一条记录</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>B+树索引本身并不能找到一条记录，只能找到记录所在的页。详细见具本章节中的内容，及查看本机数据内容。找到所在页后，把页载入内存，</p>
<p>在内存中对Page Directory进行binary search。依次类推，最终找到记录(通过n_owned)。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/database/">数据库</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/innodb/">innodb</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/mysql/">mysql</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-redis-hashring" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/redis-hashring/" class="article-date">
      <time datetime="2015-04-09T04:21:25.000Z" itemprop="datePublished">2015-04-09</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/redis-hashring/">Redis::HashRing source code</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">require</span> <span class="string">'zlib'</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Redis</span></span></div><div class="line">  <span class="class"><span class="keyword">class</span> <span class="title">HashRing</span></span></div><div class="line"></div><div class="line">    POINTS_PER_SERVER = <span class="number">160</span> <span class="comment"># this is the default in libmemcached</span></div><div class="line"></div><div class="line">    <span class="keyword">attr_reader</span> <span class="symbol">:ring</span>, <span class="symbol">:sorted_keys</span>, <span class="symbol">:replicas</span>, <span class="symbol">:nodes</span></div><div class="line"></div><div class="line">    <span class="comment"># nodes is a list of objects that have a proper to_s representation.</span></div><div class="line">    <span class="comment"># replicas indicates how many virtual points should be used pr. node,</span></div><div class="line">    <span class="comment"># replicas are required to improve the distribution.</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(nodes=[], replicas=POINTS_PER_SERVER)</span></span></div><div class="line">      @replicas = replicas</div><div class="line">      @ring = &#123;&#125;</div><div class="line">      @nodes = []</div><div class="line">      @sorted_keys = []</div><div class="line">      nodes.each <span class="keyword">do</span> <span class="params">|node|</span></div><div class="line">        add_node(node)</div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="comment"># Adds a `node` to the hash ring (including a number of replicas).</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_node</span><span class="params">(node)</span></span></div><div class="line">      @nodes &lt;&lt; node</div><div class="line">      @replicas.times <span class="keyword">do</span> <span class="params">|i|</span></div><div class="line">        key = Zlib.crc32(<span class="string">"<span class="subst">#&#123;node.id&#125;</span>:<span class="subst">#&#123;i&#125;</span>"</span>)</div><div class="line">        @ring[key] = node</div><div class="line">        @sorted_keys &lt;&lt; key</div><div class="line">      <span class="keyword">end</span></div><div class="line">      @sorted_keys.sort!</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">remove_node</span><span class="params">(node)</span></span></div><div class="line">      @nodes.reject!&#123;<span class="params">|n|</span> n.id == node.id&#125;</div><div class="line">      @replicas.times <span class="keyword">do</span> <span class="params">|i|</span></div><div class="line">        key = Zlib.crc32(<span class="string">"<span class="subst">#&#123;node.id&#125;</span>:<span class="subst">#&#123;i&#125;</span>"</span>)</div><div class="line">        @ring.delete(key)</div><div class="line">        @sorted_keys.reject! &#123;<span class="params">|k|</span> k == key&#125;</div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="comment"># get the node in the hash ring for this key</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_node</span><span class="params">(key)</span></span></div><div class="line">      get_node_pos(key)[<span class="number">0</span>]</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_node_pos</span><span class="params">(key)</span></span></div><div class="line">      <span class="keyword">return</span> [<span class="literal">nil</span>,<span class="literal">nil</span>] <span class="keyword">if</span> @ring.size == <span class="number">0</span></div><div class="line">      crc = Zlib.crc32(key)</div><div class="line">      idx = HashRing.binary_search(@sorted_keys, crc)</div><div class="line">      <span class="keyword">return</span> [@ring[@sorted_keys[idx]], idx]</div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">iter_nodes</span><span class="params">(key)</span></span></div><div class="line">      <span class="keyword">return</span> [<span class="literal">nil</span>,<span class="literal">nil</span>] <span class="keyword">if</span> @ring.size == <span class="number">0</span></div><div class="line">      <span class="number">_</span>, pos = get_node_pos(key)</div><div class="line">      @sorted_keys[pos..-<span class="number">1</span>].each <span class="keyword">do</span> <span class="params">|k|</span></div><div class="line">        <span class="keyword">yield</span> @ring[k]</div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">    <span class="class"><span class="keyword">class</span> &lt;&lt; self</span></div><div class="line"></div><div class="line">      <span class="comment"># gem install RubyInline to use this code</span></div><div class="line">      <span class="comment"># Native extension to perform the binary search within the hashring.</span></div><div class="line">      <span class="comment"># There's a pure ruby version below so this is purely optional</span></div><div class="line">      <span class="comment"># for performance.  In testing 20k gets and sets, the native</span></div><div class="line">      <span class="comment"># binary search shaved about 12% off the runtime (9sec -&gt; 8sec).</span></div><div class="line">      <span class="keyword">begin</span></div><div class="line">        <span class="keyword">require</span> <span class="string">'inline'</span></div><div class="line">        inline <span class="keyword">do</span> <span class="params">|builder|</span></div><div class="line">          builder.c &lt;&lt;-EOM</div><div class="line">          int binary_search(VALUE ary, unsigned int r) &#123;</div><div class="line">              int upper = RARRAY_LEN(ary) - <span class="number">1</span>;</div><div class="line">              int lower = <span class="number">0</span>;</div><div class="line">              int idx = <span class="number">0</span>;</div><div class="line"></div><div class="line">              <span class="keyword">while</span> (lower &lt;= upper) &#123;</div><div class="line">                  idx = (lower + upper) / <span class="number">2</span>;</div><div class="line"></div><div class="line">                  VALUE continuumValue = RARRAY_PTR(ary)[idx];</div><div class="line">                  unsigned int l = NUM2UINT(continuumValue);</div><div class="line">                  <span class="keyword">if</span> (l == r) &#123;</div><div class="line">                      <span class="keyword">return</span> idx;</div><div class="line">                  &#125;</div><div class="line">                  <span class="keyword">else</span> <span class="keyword">if</span> (l &gt; r) &#123;</div><div class="line">                      upper = idx - <span class="number">1</span>;</div><div class="line">                  &#125;</div><div class="line">                  <span class="keyword">else</span> &#123;</div><div class="line">                      lower = idx + <span class="number">1</span>;</div><div class="line">                  &#125;</div><div class="line">              &#125;</div><div class="line">              <span class="keyword">if</span> (upper &lt; <span class="number">0</span>) &#123;</div><div class="line">                upper = RARRAY_LEN(ary) - <span class="number">1</span>;</div><div class="line">              &#125;</div><div class="line">              <span class="keyword">return</span> upper;</div><div class="line">          &#125;</div><div class="line">          EOM</div><div class="line">        <span class="keyword">end</span></div><div class="line">      <span class="keyword">rescue</span> Exception</div><div class="line">        <span class="comment"># Find the closest index in HashRing with value &lt;= the given value</span></div><div class="line">        <span class="function"><span class="keyword">def</span> <span class="title">binary_search</span><span class="params">(ary, value, &amp;block)</span></span></div><div class="line">          upper = ary.size - <span class="number">1</span></div><div class="line">          lower = <span class="number">0</span></div><div class="line">          idx = <span class="number">0</span></div><div class="line"></div><div class="line">          <span class="keyword">while</span>(lower &lt;= upper) <span class="keyword">do</span></div><div class="line">            idx = (lower + upper) / <span class="number">2</span></div><div class="line">            comp = ary[idx] &lt;=&gt; value</div><div class="line"></div><div class="line">            <span class="keyword">if</span> comp == <span class="number">0</span></div><div class="line">              <span class="keyword">return</span> idx</div><div class="line">            <span class="keyword">elsif</span> comp &gt; <span class="number">0</span></div><div class="line">              upper = idx - <span class="number">1</span></div><div class="line">            <span class="keyword">else</span></div><div class="line">              lower = idx + <span class="number">1</span></div><div class="line">            <span class="keyword">end</span></div><div class="line">          <span class="keyword">end</span></div><div class="line"></div><div class="line">          <span class="keyword">if</span> upper &lt; <span class="number">0</span></div><div class="line">            upper = ary.size - <span class="number">1</span></div><div class="line">          <span class="keyword">end</span></div><div class="line">          <span class="keyword">return</span> upper</div><div class="line">        <span class="keyword">end</span></div><div class="line"></div><div class="line">      <span class="keyword">end</span></div><div class="line">    <span class="keyword">end</span></div><div class="line"></div><div class="line">  <span class="keyword">end</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/redis/">redis</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-mac-use-lsof-to-show-which-process-use-the-port" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/mac-use-lsof-to-show-which-process-use-the-port/" class="article-date">
      <time datetime="2015-04-08T09:39:26.000Z" itemprop="datePublished">2015-04-08</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/mac-use-lsof-to-show-which-process-use-the-port/">mac 查看端口占用程序</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>mac 查看端口占用程序<br>lsof -i :9001</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/development/">程序开发</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/mac/">mac</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
    <article id="post-how-to-understanding-something-that-is-complex-and-poorly-documented" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/how-to-understanding-something-that-is-complex-and-poorly-documented/" class="article-date">
      <time datetime="2015-04-07T12:27:04.000Z" itemprop="datePublished">2015-04-07</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/how-to-understanding-something-that-is-complex-and-poorly-documented/">how to understanding something that is complex and poorly documented</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <blockquote>
<p>An approach I’ve long taken to understanding something that is complex and poorly documented is the following three steps:</p>
<ol>
<li><p>Read the existing documentation and the existing code, until a basic understanding is reached. Often there are serious misunderstandings or incorrect factorization at this step.</p>
</li>
<li><p>Write my own implementation, even a very basic and broken one, preferably in a completely different language (which avoids the tendency to cut and paste anything). Revise my understanding based on what works and what doesn’t.</p>
</li>
<li><p>Create new documentation and diagrams based on my new understanding. Refactor my implementation as necessary (the act of reviewing everything in order to document it often reveals incorrect factorizations). Correct documentation based on new understanding from refactoring code. Repeat until correct.</p>
</li>
</ol>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/category/database/">数据库</a>
    </div>


      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tag/mysql/">mysql</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>










  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/41/">41</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i>
                2009~2016 戛戛Happy
            </div>
            <div class="footer-right">
                 <i class="fa fa-heart animated infinite pulse"></i> <a href="http://hexo.io/" target="_blank" title="快速、简洁且高效的博客框架">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="简而不减 Hexo 双栏博客主题  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-sitemap"></i>
                 <a href="/sitemap.xml" target="_blank">XML谷歌</a> <a href="/sitemap_baidu.xml" target="_blank">XML百度</a>
                 <i class="fa fa-bar-chart"></i> <script src="http://s15.cnzz.com/stat.php?id=2325808&web_id=2325808" language="JavaScript"></script>
            </div>
        </div>
        
    </div>
</footer>

    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>



<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17621945-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



<div class="scroll" id="scroll">
    <a href="#" title="返回顶部"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="查看评论"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="转到底部"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>


  </div>
</body>
</html>